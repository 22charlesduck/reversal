














Epoch: [0/2000] Loss: 4.4297 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.75it/s]
Epoch: [1/2000] Loss: 4.3845 Acc: 0.00%:   1%|█                                                                                                                      | 1/118 [00:00<00:27,  4.28it/s]















Epoch: [1/2000] Loss: 4.4765 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.73it/s]
Epoch: [2/2000] Loss: 4.4925 Acc: 0.00%:   3%|███                                                                                                                    | 3/118 [00:00<00:30,  3.83it/s]















Epoch: [2/2000] Loss: 4.4457 Acc: 0.00%:  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 115/118 [00:30<00:00,  3.71it/s]
Epoch: [2/2000] Loss: 4.4455 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.72it/s]















Epoch: [3/2000] Loss: 4.4112 Acc: 0.00%:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████  | 116/118 [00:31<00:00,  3.71it/s]
Epoch: [3/2000] Loss: 4.4112 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.72it/s]














Epoch: [4/2000] Loss: 4.4030 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.73it/s]
Epoch: [5/2000] Loss: 4.3804 Acc: 0.00%:   1%|█                                                                                                                      | 1/118 [00:00<00:27,  4.25it/s]















Epoch: [5/2000] Loss: 4.4510 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.73it/s]
Epoch: [6/2000] Loss: 4.4989 Acc: 0.00%:   1%|█                                                                                                                      | 1/118 [00:00<00:27,  4.26it/s]



























Epoch: [6/2000] Loss: 4.5145 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:56<00:00,  2.10it/s]
  0%|                                                                                                                                                                        | 0/118 [00:00<?, ?it/s]















Epoch: [7/2000] Loss: 4.4784 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.71it/s]
Epoch: [8/2000] Loss: 4.4643 Acc: 0.00%:   2%|██                                                                                                                     | 2/118 [00:00<00:29,  3.90it/s]















Epoch: [8/2000] Loss: 4.4750 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.72it/s]
Epoch: [9/2000] Loss: 4.4618 Acc: 0.00%:   3%|███                                                                                                                    | 3/118 [00:00<00:30,  3.83it/s]















Epoch: [9/2000] Loss: 4.4743 Acc: 0.00%:  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 115/118 [00:30<00:00,  3.72it/s]
Epoch: [9/2000] Loss: 4.4746 Acc: 0.00%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:31<00:00,  3.73it/s]

Epoch: [10/2000] Loss: 4.4624 Acc: 0.00%:  11%|████████████▉                                                                                                        | 13/118 [00:03<00:29,  3.57it/s]
Traceback (most recent call last):
  File "/home/clding/aditi/reversal/train.py", line 139, in <module>
    logits, loss, accs = model(x, y, attn_mask)
  File "/home/clding/miniconda3/envs/reversal/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/clding/miniconda3/envs/reversal/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/clding/aditi/reversal/models/base_model.py", line 101, in forward
    acc, token_acc = accuracy(logits, targets)
  File "/home/clding/aditi/reversal/utils/training_utils.py", line 35, in accuracy
    num_prefix_tokens = targets[0].eq(-1).sum().item()
KeyboardInterrupt